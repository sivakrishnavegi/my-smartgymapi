  console.error
    [ListUsers] Error listing users: TypeError: users_schema_1.default.find(...).populate is not a function
        at /Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/controllers/userController.ts:146:8
        at Generator.next (<anonymous>)
        at /Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/controllers/userController.ts:8:71
        at new Promise (<anonymous>)
        at __awaiter (/Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/controllers/userController.ts:4:12)
        at listUsers (/Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/controllers/userController.ts:143:64)
        at /Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/__tests__/iamUser.test.ts:38:28
        at Generator.next (<anonymous>)
        at /Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/__tests__/iamUser.test.ts:8:71
        at new Promise (<anonymous>)
        at __awaiter (/Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/__tests__/iamUser.test.ts:4:12)
        at Object.<anonymous> (/Users/sivakrishnavegi/Desktop/code/my-gymapi/src/modules/iam/__tests__/iamUser.test.ts:36:54)
        at Promise.finally.completed (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:1557:28)
        at new Promise (<anonymous>)
        at callAsyncCircusFn (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:1497:10)
        at _callCircusTest (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:1007:40)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at _runTest (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:947:3)
        at /Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:849:7
        at _runTestsForDescribeBlock (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:862:11)
        at _runTestsForDescribeBlock (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at _runTestsForDescribeBlock (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:857:11)
        at run (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:761:3)
        at runAndTransformResultsToJestFormat (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/jestAdapterInit.js:1918:21)
        at jestAdapter (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-circus/build/runner.js:101:19)
        at runTestInternal (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-runner/build/index.js:275:16)
        at runTest (/Users/sivakrishnavegi/Desktop/code/my-gymapi/node_modules/jest-runner/build/index.js:343:7)

      148 |     res.status(200).json(users);
      149 |   } catch (err: any) {
    > 150 |     console.error("[ListUsers] Error listing users:", err);
          |             ^
      151 |     await logError(req, err);
      152 |     res.status(500).json({ error: "Internal server error" });
      153 |   }

      at src/modules/iam/controllers/userController.ts:150:13
      at src/modules/iam/controllers/userController.ts:8:71
      at __awaiter (src/modules/iam/controllers/userController.ts:4:12)
      at listUsers (src/modules/iam/controllers/userController.ts:143:64)
      at src/modules/iam/__tests__/iamUser.test.ts:38:28
      at src/modules/iam/__tests__/iamUser.test.ts:8:71
      at __awaiter (src/modules/iam/__tests__/iamUser.test.ts:4:12)
      at Object.<anonymous> (src/modules/iam/__tests__/iamUser.test.ts:36:54)

FAIL src/modules/iam/__tests__/iamUser.test.ts (15.032 s)
  IAM UserController
    listUsers
      ✕ should return list of users (333 ms)
    getUserById
      ✕ should return user if found (11 ms)
      ✕ should return 404 if not found (177 ms)

  ● IAM UserController › listUsers › should return list of users

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 200
    Received: 500

    Number of calls: 1

      37 |             (User.find as jest.Mock).mockResolvedValue([]);
      38 |             await listUsers(req, res);
    > 39 |             expect(res.status).toHaveBeenCalledWith(200);
         |                                ^
      40 |             expect(Array.isArray(res.json.mock.calls[0][0])).toBe(true);
      41 |         });
      42 |     });

      at src/modules/iam/__tests__/iamUser.test.ts:39:32
      at fulfilled (src/modules/iam/__tests__/iamUser.test.ts:5:58)

  ● IAM UserController › getUserById › should return user if found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 200
    Received: 400

    Number of calls: 1

      50 |             await getUserById(req, res);
      51 |
    > 52 |             expect(res.status).toHaveBeenCalledWith(200);
         |                                ^
      53 |             expect(res.json).toHaveBeenCalledWith(mockUser);
      54 |         });
      55 |

      at src/modules/iam/__tests__/iamUser.test.ts:52:32
      at fulfilled (src/modules/iam/__tests__/iamUser.test.ts:5:58)

  ● IAM UserController › getUserById › should return 404 if not found

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    Expected: 404
    Received: 400

    Number of calls: 1

      57 |             (User.findById as jest.Mock).mockResolvedValue(null);
      58 |             await getUserById(req, res);
    > 59 |             expect(res.status).toHaveBeenCalledWith(404);
         |                                ^
      60 |         });
      61 |     });
      62 | });

      at src/modules/iam/__tests__/iamUser.test.ts:59:32
      at fulfilled (src/modules/iam/__tests__/iamUser.test.ts:5:58)

Test Suites: 1 failed, 1 total
Tests:       3 failed, 3 total
Snapshots:   0 total
Time:        15.092 s
Ran all test suites matching src/modules/iam/__tests__/iamUser.test.ts.
